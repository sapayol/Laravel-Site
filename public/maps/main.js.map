{"version":3,"sources":["controllers.js","factories.js","main.js","notifcationService.js"],"names":["controllers","angular","module","sapayolControllers","controller","$scope","$http","$q","selectedColumn","jacket","leather_type","leather_color","lining_color","hardware_color","size","$rootScope","$document","Session","notifyUser","flushSession","then","of","getSession","getCurrent","session","console","log","init","sapayol","user","userInfoSubmitted","scrollToElement","element","address","shippingInfoSubmitted","submitUserInfo","order_id","userInfoForm","$valid","addUserInfoToOrder","response","showUserErorrs","submitShippingInfo","shippingInfoForm","addShippingInfoToOrder","showShippingErorrs","deferred","defer","post","_method","name","email","success","status","resolve","error","ofApiErrors","promise","address1","address2","city","postcode","province","country","Stripe","setPublishableKey","stripeResponseHandler","ofErrorMessage","message","card","stripe_token","id","paymentInfoSubmitted","factories","sessionFactory","factory","get","getValueOf","key","store","paramsToStore","params","forEach","value","run","$timeout","$","document","ready","slick","dots","mobileFirst","directive","restrict","link","scope","$elm","on","animate","scrollTop","click","location","pathname","replace","this","hostname","target","hash","length","slice","offset","top","plyr","setup","controls","services","notificationServices","notify","notifyOfValidationError","data","val","searchTextRegExp","RegExp","template","messageTemplate","classes","alert","ofWarningMessage","ofSuccessMessage"],"mappings":"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","file":"main.js","sourcesContent":["var controllers = angular.module('controllers', [\n\t'sapayolControllers',\n]);\n\nvar sapayolControllers = angular.module('sapayolControllers', []);\n\nsapayolControllers.controller('lookAndFitCtrl', ['$scope', '$http', '$q', function($scope, $http, $q) {\n\t$scope.selectedColumn = 0;\n\t$scope.jacket = {\n\t\tleather_type: 'lamb heavy',\n    leather_color:  'black',\n    lining_color:  'black',\n    hardware_color: 'silver',\n    size: 44\n\t};\n}]);\n\nsapayolControllers.controller('GlobalCtrl', ['$rootScope', '$document', 'Session', '$scope', 'notifyUser', function($rootScope, $document, Session, $scope, notifyUser) {\n\t\t$rootScope.flushSession = function() {\n\t\t\tSession.delete('flush').then(function(){\n\t\t\t\tnotifyUser.of('Session flushed');\n\t\t\t});\n\t\t};\n\n\t\t$rootScope.getSession = function() {\n\t\t\tSession.getCurrent().then(function(session){\n\t\t\t\tconsole.log(session);\n\t\t\t});\n\t\t};\n}]);\n\n\nsapayolControllers.controller('checkoutCtrl', ['$scope', '$http', '$q', '$document', 'notifyUser',  function($scope, $http, $q, $document, notifyUser) {\n\n\tinit = function() {\n\t\tif (sapayol.user !== null) {\n\t\t\t$scope.user = sapayol.user;\n\t\t\t$scope.userInfoSubmitted = true;\n\t\t\t$document.scrollToElement(angular.element('#shipping-info'), 80, 500);\n\t\t};\n\t\tif (sapayol.address !== null) {\n\t\t\t$scope.address = sapayol.address;\n\t\t\t$scope.shippingInfoSubmitted = true;\n\t\t\t$document.scrollToElement(angular.element('#payment-info'), 80, 500);\n\t\t};\n\t}\n\n\t$scope.submitUserInfo = function(order_id) {\n\t  if ($scope.userInfoForm.$valid) {\n\t  \taddUserInfoToOrder($scope.user, order_id).then(function(response){\n\t\t\t\t$scope.userInfoSubmitted = true;\n\t\t\t\t$document.scrollToElement(angular.element('#shipping-info'), 80, 500);\n\t  \t});\n\t  } else {\n\t  \t$scope.showUserErorrs = true;\n\t  }\n\t};\n\n\t$scope.submitShippingInfo = function(order_id) {\n\t  if ($scope.shippingInfoForm.$valid) {\n\t  \taddShippingInfoToOrder($scope.address, order_id).then(function(response){\n\t  \t\tconsole.log(response);\n\t\t\t\t$scope.shippingInfoSubmitted = true;\n\t\t\t\t$document.scrollToElement(angular.element('#payment-info'), 80, 500);\n\t  \t});\n\t  } else {\n\t  \t$scope.showShippingErorrs = true;\n\t  }\n\t};\n\n\taddUserInfoToOrder = function(user, order_id) {\n\t\tvar deferred = $q.defer();\n\t\t$http.post('/orders/' + order_id, {\n\t\t\t_method: \"PATCH\",\n\t\t\tname: user.name,\n\t\t\temail: user.email,\n\t\t}).success(function(response, status) {\n\t\t\tdeferred.resolve(response);\n\t\t}).error(function(response, status) {\n\t\t\tnotifyUser.ofApiErrors(response, status);\n\t\t});\n\t\treturn deferred.promise;\n\t}\n\n\taddShippingInfoToOrder = function(address, order_id) {\n\t\tvar deferred = $q.defer();\n\t\t$http.post('/orders/' + order_id, {\n\t\t\t_method: 'PATCH',\n\t\t\taddress1: address.address1,\n\t\t\taddress2: address.address2,\n\t\t\tcity:     address.city,\n\t\t\tpostcode: address.postcode,\n\t\t\tprovince: address.province,\n\t\t\tcountry:  address.country,\n\t\t}).success(function(response, status) {\n\t\t\tdeferred.resolve(response);\n\t\t}).error(function(response, status) {\n\t\t\tnotifyUser.ofApiErrors(response, status);\n\t\t});\n\t\treturn deferred.promise;\n\t}\n\n\tStripe.setPublishableKey('pk_test_G2k7gKlVNK1rpGMDeF5FDIhO');\n\n\t$scope.stripeResponseHandler = function(status, response) {\n\t\tif(response.error) {\n\t  \tif (status == 400) {\n\t\t  \tnotifyUser.ofErrorMessage(response.error);\n\t  \t} else {\n\t\t  \tnotifyUser.ofErrorMessage(response.error.message);\n\t  \t};\n\t  } else {\n\t\t\t$scope.card = response.card;\n\t\t\t$scope.stripe_token = response.id;\n\t\t\t$scope.paymentInfoSubmitted = true;\n\t\t\tconsole.log(response);\n\t\t}\n\t};\n\n\tinit();\n\n}]);\n","var factories = angular.module('factories', [\n\t'sessionFactory'\n]);\n\nvar sessionFactory = angular.module('sessionFactory', []);\n\n\nsessionFactory.factory('Session', ['$http', '$q', function($http, $q) {\n\n\tsession = {};\n\n\tsession.getCurrent = function() {\n\t\tvar deferred = $q.defer();\n\t\t$http.get('/session')\n\t\t\t.success(function(response, status) {\n\t\t\t\tdeferred.resolve(response);\n\t\t  }).error(function(response, status) {\n \t\t\t\treturn response;\n\t\t  });\n\t\treturn deferred.promise;\n\t}\n\n\tsession.getValueOf = function(key) {\n\t\tvar deferred = $q.defer();\n\t\t$http.get('/session/' + key)\n\t\t\t.success(function(response, status) {\n\t\t\t\tdeferred.resolve(response);\n\t\t  }).error(function(response, status) {\n \t\t\t\treturn response;\n\t\t  });\n\t\treturn deferred.promise;\n\t}\n\n\tsession.store = function(paramsToStore) {\n\t\tvar params = {};\n\t\tangular.forEach(paramsToStore, function(value, key) {\n\t\t\tparams[key] = value;\n\t\t});\n\t\tvar deferred = $q.defer();\n\t\t$http.post(\"/session\", params).success(function(response, status) {\n\t\t\tdeferred.resolve(response);\n\t\t}).error(function(response, status) {\n\t\t\treturn response;\n\t\t});\n\t\treturn deferred.promise;\n  };\n\n\tsession.delete = function(key) {\n\t\tvar deferred = $q.defer();\n\t\t$http.delete(\"/session/\" + key, {\n\t\t}).success(function(response, status) {\n\t\t\tdeferred.resolve(response);\n\t\t}).error(function(response, status) {\n\t\t\treturn response;\n\t\t});\n\t\treturn deferred.promise;\n  };\n\n\treturn session;\n\n}]);\n","(function() {\n  'use strict';\n\n  var sapayolApp = angular.module('sapayolApp', [\n    'controllers',\n    'services',\n    'factories',\n    'duScroll',\n    'cgNotify',\n    'angularPayments',\n    'angular-loading-bar',\n    'ngMask'\n  ])\n  .run(['$timeout', function($timeout) {\n    $timeout(function() {\n\t\t\t$(document).ready(function(){\n\t\t\t  $('.home-carousel').slick({\n\t\t\t  \tdots: true,\n\t\t\t  \tmobileFirst: true,\n\t\t\t  });\n\t\t\t});\n      // $(document).foundation();\n    }, 500);\n  }])\n  .directive('scrollToTop', function() {\n    return {\n      restrict: 'A',\n      link: function(scope, $elm) {\n        $elm.on('click', function() {\n          $(\"body\").animate({scrollTop: 0}, \"slow\");\n        });\n      }\n    }\n  });\n\n  // Smooth scrolling on anchor tags\n  $(function() {\n    $('a[href*=#]:not([href=#])').click(function() {\n      if (location.pathname.replace(/^\\//,'') == this.pathname.replace(/^\\//,'') && location.hostname == this.hostname) {\n        var target = $(this.hash);\n        target = target.length ? target : $('[name=' + this.hash.slice(1) +']');\n        if (target.length) {\n          $('html,body').animate({\n            scrollTop: target.offset().top\n          }, 1000);\n          return false;\n        }\n      }\n    });\n  });\n\n  plyr.setup({\n    controls: [\"play\", \"fullscreen\"]\n  });\n\n})();\n\n","var services = angular.module('services', ['notificationServices']);\n\nvar notificationServices = angular.module('notificationServices', []);\n\nnotificationServices.factory('notifyUser', ['notify', function(notify) {\n\n\tnotifyOfValidationError = function(data) {\n\t\tangular.forEach(data, function(error, val) {\n\t\t\tvar searchTextRegExp = new RegExp(val , \"i\");\n\t\t\terror            = error[0].replace(searchTextRegExp , '<strong>$&</strong>'),\n\t\t\ttemplate         = \"<span>\",\n\t\t\ttemplate         += error + '<br>',\n\t\t\ttemplate         += \"</span>\";\n\t  \treturn notify({ messageTemplate: template, classes: 'alert' });\n\t  });\n\t}\n\n\treturn {\n\t\tofApiErrors: function(response, status) {\n\t\t\tif (typeof(response) == 'string') {\n\t\t\t\treturn notify({ message: response, classes: alert });\n\t\t\t};\n\t\t\tif (status === 422) {\n\t\t\t\treturn notifyOfValidationError(response);\n\t\t\t} else if (status === 500) {\n\t\t\t\treturn notify({ message: response.error, classes: 'alert' });\n\t\t\t} else {\n\t\t\t\treturn notify({ message: response.message, classes: 'alert' });\n\t\t\t}\n\t\t},\n\t\tofErrorMessage: function(error) {\n\t\t\treturn notify({ message: error, classes: 'alert' });\n\t\t},\n\t  ofWarningMessage: function(data) {\n\t\t\treturn notify({ message: data, classes: 'warning' });\n\t  },\n\t\tofSuccessMessage: function(data) {\n\t\t\treturn notify({ message: data, classes: 'success' });\n\t  },\n\t\tof: function(data) {\n\t  \treturn notify(data);\n\t\t}\n\t}\n\n}]);\n"],"sourceRoot":"/source/"}